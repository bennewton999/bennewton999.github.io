---
layout: post
title: Calling the UPS ratefinder API in Classic ASP
categories:
- ASP
tags:
- API
- ASP
- Sample Code
- UPS
status: publish
type: post
published: true
meta: {}
---
<p>Last week I started this blog with some quick and dirty code for calling the rate finder API from the USPS. As with most API's, Classic ASP samples are hard to come by these days. So here is a sample of the UPS code. Remember, you have to have a web tools account with UPS which you can get here.
<pre lang="VB"> 0 then

response.write "DOM Not Loaded"

end if

'check for error
xmlQuery = "*/Error"

set errorNode = xmlDOM.documentElement.selectNodes(xmlQuery)

if not errorNode is nothing then
	errorLength = errorNode.length
		if errorLength &gt; 0 then
			rate_error_severity= errorNode.item(0).selectSingleNode("ErrorSeverity").nodeTypedValue
			rate_error_code= errorNode.item(0).selectSingleNode("ErrorCode").nodeTypedValue
			rate_error_description= errorNode.item(0).selectSingleNode("ErrorDescription").nodeTypedValue
		end if
end if

if rate_error_severity="Hard" then

	total= 0
	rate_error= rate_error_description
	'response.end()

else

rate_error=""

xmlQuery = "/RatingServiceSelectionResponse/RatedShipment"
set docHeadlines = xmlDOM.documentElement.selectNodes(xmlQuery)

total= docHeadlines.item(0).selectSingleNode("TotalCharges").selectSingleNode("MonetaryValue").nodeTypedValue
GuaranteedDaysToDelivery= docHeadlines.item(0).selectSingleNode("GuaranteedDaysToDelivery").nodeTypedValue
ScheduledDeliveryTime= docHeadlines.item(0).selectSingleNode("ScheduledDeliveryTime").nodeTypedValue

end if
%&gt;</pre>
